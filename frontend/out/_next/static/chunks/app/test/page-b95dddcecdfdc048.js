(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11],{1956:(e,t,s)=>{Promise.resolve().then(s.bind(s,2767))},2767:(e,t,s)=>{"use strict";s.d(t,{default:()=>m});var r=s(5155),a=s(2115),i=s(63),n=s(5125);let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;if(!Array.isArray(e)||0===e.length)return[];let r=e.filter(e=>!t.includes(e.id));return[...r.length>=s?r:e].sort(()=>Math.random()-.5).slice(0,s).map(e=>({id:e.id,questionText:e.questionText,questionImage:e.questionImage||null,options:e.options||[],correctAnswerIndex:e.correctAnswerIndex,difficulty:e.difficulty,explanation:e.explanation||"Based on the ".concat(e.difficulty.toLowerCase()," level question.")}))},o=e=>{let{message:t,type:s="error",onClose:i}=e;return a.useEffect(()=>{let e=setTimeout(i,4e3);return()=>clearTimeout(e)},[i]),(0,r.jsxs)("div",{className:"fixed top-4 right-4 z-50 px-6 py-3 rounded-lg text-white font-medium shadow-lg ".concat("success"===s?"bg-green-500":"warning"===s?"bg-yellow-500":"bg-red-500"," animate-fadeIn"),children:[t,(0,r.jsx)("button",{onClick:i,className:"ml-3 text-white hover:text-gray-200 focus:outline-none",children:"✕"})]})},d=e=>{let{userData:t,setUserData:s,imagePreview:a,setImagePreview:i,handleStartQuiz:n,isLoading:l,quizState:o,setQuizState:d,apiUrl:c}=e,x=localStorage.getItem("umutoza_user_name")&&"landing"===o;return(0,r.jsx)("div",{className:"min-h-screen bg-[#F0E6F7] flex items-center justify-center p-6 font-sans",children:(0,r.jsx)("div",{className:"glass max-w-lg w-full rounded-[50px] overflow-hidden shadow-2xl p-10 lg:p-16 animate-zoomIn bg-white/80 backdrop-blur-xl border border-white/50",children:x?(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"relative w-32 h-32 mx-auto mb-8",children:(0,r.jsx)("div",{className:"w-full h-full rounded-[45px] border-4 border-white shadow-2xl overflow-hidden bg-indigo-600 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-5xl font-black uppercase",children:t.name[0]})})}),(0,r.jsxs)("h1",{className:"text-3xl font-black text-indigo-900 mb-2",children:["Muraho, ",t.name,"!"]}),(0,r.jsx)("p",{className:"text-indigo-700/50 font-medium mb-12 italic",children:"Witeguye gutangira ikizamini?"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("button",{onClick:e=>n(e),disabled:l,className:"w-full py-6 bg-indigo-600 hover:bg-indigo-700 text-white rounded-[30px] font-black text-xl shadow-xl shadow-indigo-200 active:scale-95 transition-all",children:l?"Irategura...":"TANGIRA UBU"}),(0,r.jsx)("button",{onClick:()=>d("editing"),className:"w-full py-4 bg-white/50 text-indigo-600 rounded-[25px] font-bold hover:bg-white transition-all",children:"Hindura Profile"})]})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-center mb-10",children:(0,r.jsx)("h1",{className:"text-3xl font-black text-indigo-900 mb-2",children:"Iyandikishe"})}),(0,r.jsxs)("form",{onSubmit:n,className:"space-y-8",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"relative w-32 h-32 mb-4",children:(0,r.jsx)("div",{className:"w-full h-full rounded-[40px] border-4 border-white shadow-lg overflow-hidden bg-indigo-600 flex items-center justify-center transition-all",children:t.name?(0,r.jsx)("span",{className:"text-white text-5xl font-black uppercase",children:t.name[0]}):(0,r.jsx)("span",{className:"text-4xl text-white/50",children:"�"})})}),(0,r.jsx)("p",{className:"text-xs font-bold text-indigo-300 uppercase tracking-widest",children:"Profile yawe"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-widest mb-2 ml-1",children:"Izina ryawe"}),(0,r.jsx)("input",{required:!0,type:"text",value:t.name,onChange:e=>s(t=>({...t,name:e.target.value})),className:"w-full px-6 py-4 rounded-2xl bg-white border border-indigo-100 text-indigo-900 font-bold focus:outline-none focus:ring-4 focus:ring-indigo-100 focus:border-indigo-500 transition-all text-lg placeholder:text-indigo-200 shadow-sm",placeholder:"Andika izina ryawe..."})]}),(0,r.jsx)("button",{disabled:l,type:"submit",className:"w-full py-6 bg-indigo-600 hover:bg-indigo-700 text-white rounded-[30px] font-black text-xl shadow-xl shadow-indigo-100 active:scale-95 transition-all",children:l?"BIRATEGURWA...":"EMEZA & TANGIRA"}),"editing"===o&&(0,r.jsx)("button",{type:"button",onClick:()=>d("landing"),className:"w-full py-2 text-indigo-400 font-bold text-sm hover:text-indigo-600 transition-colors",children:"Subira Inyuma"})]})]})})})};var c=s(5239);let x=e=>{let{questions:t,currentQuestion:s,timeLeft:a,formatTime:i,userData:n,apiUrl:l,selectedAnswerIndex:o,handleAnswerSelect:d}=e,x=t[s],u=Math.round((s+1)/t.length*100);return(0,r.jsx)("div",{className:"min-h-screen bg-[#F0E6F7] py-6 px-4 font-sans relative",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto relative z-10",children:[(0,r.jsxs)("header",{className:"flex justify-between items-center mb-8 bg-white/40 backdrop-blur-md p-4 rounded-[30px] border border-white/50 shadow-md",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 ml-4",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl bg-indigo-600 overflow-hidden border-2 border-white shadow-sm flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white font-black uppercase text-xs",children:n.name[0]})}),(0,r.jsx)("span",{className:"font-black text-indigo-900 text-sm tracking-tight",children:n.name})]}),(0,r.jsxs)("div",{className:"bg-indigo-900 text-white px-6 py-2 rounded-2xl font-black text-xl flex items-center mr-4",children:[(0,r.jsx)("span",{className:"text-cyan-400 mr-2",children:"\uD83D\uDD52"})," ",i(a)]})]}),(0,r.jsxs)("div",{className:"mb-8 px-4",children:[(0,r.jsxs)("div",{className:"flex justify-between text-indigo-900/40 font-bold text-[10px] uppercase tracking-widest mb-2",children:[(0,r.jsxs)("span",{children:["Ikibazo ",s+1," / ",t.length]}),(0,r.jsxs)("span",{children:[u,"% Byakozwe"]})]}),(0,r.jsx)("div",{className:"h-4 bg-white/50 rounded-full overflow-hidden p-1 border border-white shadow-inner",children:(0,r.jsx)("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-cyan-400 rounded-full transition-all duration-700",style:{width:"".concat(u,"%")}})})]}),(0,r.jsxs)("div",{className:"glass rounded-[50px] overflow-hidden shadow-2xl relative p-8 md:p-16 bg-white/60 backdrop-blur-xl border border-white/60",children:[(0,r.jsx)("h2",{className:"text-2xl md:text-3xl font-extrabold text-indigo-900 mb-10 leading-tight",children:x.questionText}),x.questionImage&&(0,r.jsx)("div",{className:"mb-12 flex justify-center bg-white/50 p-6 rounded-[40px] border border-white/50 backdrop-blur-sm shadow-inner overflow-hidden relative min-h-[200px]",children:(0,r.jsx)(c.default,{src:"".concat(l).concat(x.questionImage),alt:"Quiz",fill:!0,className:"object-contain rounded-2xl transition-transform duration-500 hover:scale-105",unoptimized:!0})}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:x.options.map((e,t)=>{let s="border-white/50 bg-white/40 hover:bg-white/80 hover:border-indigo-200 hover:-translate-y-1 shadow-sm";if(null!==o){let e=t===x.correctAnswerIndex,r=t===o;s=e?"border-green-500 bg-green-50 text-green-900 shadow-xl shadow-green-100 scale-[1.02]":r?"border-red-500 bg-red-50 text-red-900 shadow-xl shadow-red-100 scale-[0.98]":"opacity-40 grayscale pointer-events-none"}return(0,r.jsxs)("button",{onClick:()=>d(t),disabled:null!==o,className:"w-full text-left p-6 rounded-[30px] border-2 transition-all duration-300 flex items-center space-x-5 ".concat(s),children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-2xl flex items-center justify-center font-black text-sm bg-indigo-100 text-indigo-700 ".concat(null!==o&&t===x.correctAnswerIndex?"bg-green-200 text-green-800":""),children:String.fromCharCode(65+t)}),(0,r.jsx)("span",{className:"font-bold text-lg leading-snug",children:e})]},t)})})]})]})})},u=e=>{let{questions:t,userResults:s,userData:i,apiUrl:n}=e,[l,o]=(0,a.useState)(null),d=s.filter(e=>e.isCorrect).length,x=t.length>0?Math.round(d/t.length*100):0;return(0,r.jsxs)("div",{className:"min-h-screen bg-[#F0E6F7] py-12 px-4 font-sans relative overflow-hidden",children:[(0,r.jsx)("div",{className:"max-w-4xl mx-auto relative z-10",children:(0,r.jsxs)("div",{className:"glass rounded-[50px] overflow-hidden shadow-2xl bg-white/80 backdrop-blur-xl border border-white/60",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-indigo-600 to-blue-500 p-12 text-center text-white relative overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-[url('/confetti.png')] opacity-20 bg-cover"}),(0,r.jsx)("h1",{className:"text-4xl md:text-5xl font-extrabold mb-4 relative z-10",children:"Ikizamini Kirarangiye!"}),(0,r.jsxs)("p",{className:"text-xl font-medium relative z-10",children:["Bravo ",i.name,", watsinze ",x,"%"]})]}),(0,r.jsxs)("div",{className:"p-8 md:p-12",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between mb-12 gap-8",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("svg",{className:"w-48 h-48 transform -rotate-90",children:[(0,r.jsx)("circle",{cx:"96",cy:"96",r:"88",stroke:"#E0E7FF",strokeWidth:"12",fill:"transparent"}),(0,r.jsx)("circle",{cx:"96",cy:"96",r:"88",stroke:"currentColor",strokeWidth:"12",fill:"transparent",strokeDasharray:552.92,strokeDashoffset:552.92-552.92*x/100,strokeLinecap:"round",className:"text-indigo-600 transition-all duration-1000"})]}),(0,r.jsx)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:(0,r.jsxs)("span",{className:"text-5xl font-extrabold text-indigo-900",children:[x,"%"]})})]}),(0,r.jsxs)("div",{className:"flex-1 grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"bg-green-50 p-6 rounded-[30px] border-2 border-green-100 text-center",children:[(0,r.jsx)("p",{className:"text-green-600 font-bold text-xs uppercase mb-1",children:"Nibyo"}),(0,r.jsx)("p",{className:"text-4xl font-extrabold text-green-700",children:d})]}),(0,r.jsxs)("div",{className:"bg-red-50 p-6 rounded-[30px] border-2 border-red-100 text-center",children:[(0,r.jsx)("p",{className:"text-red-600 font-bold text-xs uppercase mb-1",children:"Sibyo"}),(0,r.jsx)("p",{className:"text-4xl font-extrabold text-red-700",children:t.length-d})]})]})]}),(0,r.jsx)("div",{className:"mb-10 text-center",children:(0,r.jsx)("h2",{className:"text-2xl font-black text-indigo-900 uppercase tracking-tighter italic",children:"Subiramo ibisubizo byawe"})}),(0,r.jsx)("div",{className:"space-y-6 mb-12 max-h-[600px] overflow-y-auto pr-4 custom-scrollbar",children:t.map((e,t)=>{let a=s[t]||{},i=l===e.id;return(0,r.jsxs)("div",{className:"bg-white rounded-[30px] border-2 transition-all p-1 ".concat(a.isCorrect?"border-green-100":"border-red-100"),children:[(0,r.jsxs)("div",{className:"p-6 cursor-pointer flex items-center justify-between",onClick:()=>o(i?null:e.id),children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-2xl flex items-center justify-center font-bold shadow-sm ".concat(a.isCorrect?"bg-green-500 text-white":"bg-red-500 text-white"),children:t+1}),(0,r.jsx)("p",{className:"font-bold text-indigo-900 truncate max-w-[200px] md:max-w-md",children:e.questionText})]}),(0,r.jsx)("span",{className:"text-indigo-400 font-bold",children:i?"▲":"▼"})]}),i&&(0,r.jsxs)("div",{className:"px-6 pb-6 pt-2 border-t border-indigo-50",children:[(0,r.jsx)("p",{className:"text-lg font-bold text-indigo-900 mb-6",children:e.questionText}),e.questionImage&&(0,r.jsx)("div",{className:"relative w-full h-64 mb-6 shadow-sm bg-slate-50 rounded-2xl overflow-hidden",children:(0,r.jsx)(c.default,{src:"".concat(n).concat(e.questionImage),fill:!0,className:"object-contain",alt:"Q",unoptimized:!0})}),(0,r.jsx)("div",{className:"space-y-3",children:e.options.map((t,s)=>{let i=s===e.correctAnswerIndex,n=s===a.userChoice;return(0,r.jsxs)("div",{className:"p-4 rounded-2xl border-2 flex items-center space-x-3 ".concat(i?"border-green-500 bg-green-50 text-green-700 font-bold":n?"border-red-500 bg-red-50 text-red-700":"border-slate-100 bg-slate-50 text-slate-500"),children:[(0,r.jsx)("span",{className:"w-6 h-6 rounded-lg bg-white/50 flex items-center justify-center text-xs font-bold",children:String.fromCharCode(65+s)}),(0,r.jsx)("span",{children:t})]},s)})}),e.explanation&&(0,r.jsxs)("div",{className:"mt-6 p-4 bg-indigo-50 rounded-2xl text-indigo-700 border-l-4 border-indigo-400 italic text-sm",children:["\uD83D\uDCA1 ",e.explanation]})]})]},e.id)})}),(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"w-full py-6 bg-indigo-600 hover:bg-indigo-700 text-white rounded-[30px] font-black text-xl shadow-xl active:scale-95 transition-all",children:"GERAGEZA BUSHYA"})]})]})}),(0,r.jsx)("style",{children:".custom-scrollbar::-webkit-scrollbar { width: 4px; } .custom-scrollbar::-webkit-scrollbar-thumb { background: #c7d2fe; border-radius: 10px; }"})]})};s(5495);let m=()=>{(0,i.useRouter)();let e="https://umutoza-umutoza.hf.space",[t,s]=(0,a.useState)("landing"),[c,m]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),[b,p]=(0,a.useState)(null),[f,w]=(0,a.useState)({name:"",image:null,persistedImageUrl:null}),[j,v]=(0,a.useState)(null);(0,a.useEffect)(()=>{{let e=localStorage.getItem("umutoza_session_id"),t=localStorage.getItem("umutoza_user_name"),s=localStorage.getItem("umutoza_user_image");e&&p({id:e}),w(e=>({...e,name:t||"",persistedImageUrl:s||null})),v(s||null)}},[]);let[N,y]=(0,a.useState)([]),[k,I]=(0,a.useState)(0),[z,S]=(0,a.useState)(null),[A,C]=(0,a.useState)(1200),[_,q]=(0,a.useState)([]),[E,D]=(0,a.useState)({show:!1,isCorrect:!1,correctAnswer:""}),T=(0,a.useRef)(null),U=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error";return g({message:e,type:t})},F=async t=>{if(t&&t.preventDefault(),!f.name.trim())return U("Izina rirakenewe");m(!0);try{let t,r=await n.A.get("".concat(e,"/api/admin/quiz")),a=l(r.data,[],20);if(0===a.length)return void U("Nta bibazo bihari ubu.");let i=localStorage.getItem("umutoza_session_id"),o=localStorage.getItem("umutoza_user_name");if(i&&o&&o.toLowerCase()!==f.name.trim().toLowerCase())try{t=(await n.A.put("".concat(e,"/api/sessions/").concat(i),{userName:f.name.trim(),activity:"Yahinduye izina"})).data,localStorage.setItem("umutoza_user_name",f.name.trim())}catch(e){if(e.response&&409===e.response.status)return void U("Iri zina ryamaze gukoreshwa nundi muntu. Hitamo irindi.","error");throw e}else{let s=new FormData;s.append("name",f.name),i&&s.append("sessionId",i);let r=await n.A.post("".concat(e,"/api/sessions/start"),s);t=r.data,localStorage.setItem("umutoza_user_name",f.name),localStorage.setItem("umutoza_session_id",r.data.id)}p(t),q([]),S(null),I(0),C(1200),D({show:!1,isCorrect:!1,correctAnswer:""}),"completed"===t.status?s("result"):(y(a),s("quiz"),R())}catch(e){e.response&&409===e.response.status?U("Iri zina ryamaze gukoreshwa nundi muntu.","error"):(console.error(e),U("Ntibishoboye gufungura ikizamini."))}finally{m(!1)}},R=()=>{T.current&&clearInterval(T.current),T.current=setInterval(()=>{C(e=>e<=1?(clearInterval(T.current),B(),0):e-1)},1e3)},M=async t=>{if(null!==z)return;let s=N[k],r=t===s.correctAnswerIndex;S(t),q([..._,{id:s.id,isCorrect:r,userChoice:t,correctChoice:s.correctAnswerIndex}]);let a=Math.round((k+1)/N.length*100),i=k>=N.length-1;try{await n.A.put("".concat(e,"/api/sessions/").concat(b.id),{progress:a,status:i?"completed":"active",activity:"Ari mu Kizamini"})}catch(e){console.error("Sync failed",e)}setTimeout(()=>{i?B():(I(e=>e+1),S(null),D({show:!1,isCorrect:!1,correctAnswer:""}))},1e3)},B=()=>{s("result"),T.current&&clearInterval(T.current),b&&n.A.put("".concat(e,"/api/sessions/").concat(b.id),{status:"completed",activity:"Yarangije Ikizamini"}).catch(e=>console.error(e))};return(0,r.jsxs)("div",{children:[("landing"===t||"editing"===t)&&(0,r.jsx)(d,{userData:f,setUserData:w,imagePreview:j,setImagePreview:v,handleStartQuiz:F,isLoading:c,quizState:t,setQuizState:s,apiUrl:e}),"quiz"===t&&(0,r.jsx)(x,{questions:N,currentQuestion:k,timeLeft:A,formatTime:e=>{let t=Math.floor(e/60);return"".concat(t.toString().padStart(2,"0"),":").concat((e%60).toString().padStart(2,"0"))},userData:f,apiUrl:e,selectedAnswerIndex:z,handleAnswerSelect:M}),"result"===t&&(0,r.jsx)(u,{questions:N,userResults:_,userData:f,apiUrl:e}),h&&(0,r.jsx)(o,{message:h.message,type:h.type,onClose:()=>g(null)})]})}}},e=>{e.O(0,[120,239,876,441,255,358],()=>e(e.s=1956)),_N_E=e.O()}]);