"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[876],{5495:(e,t,o)=>{o.d(t,{default:()=>n});var l=o(5155),a=o(2115),r=o(63),c=o(5125);let n=e=>{let{forceActive:t=!1}=e,[o,n]=(0,a.useState)([]),[s,i]=(0,a.useState)(new Date),[d,m]=(0,a.useState)([]),p="https://umutoza-umutoza.hf.space",u=(0,r.usePathname)(),h=(0,a.useCallback)(async()=>{try{let e=(await c.A.get("".concat(p,"/api/promotions/public"))).data;n(e),localStorage.setItem("cached_promotions",JSON.stringify(e));let t=new Set(e.map(e=>e.id));Object.keys(localStorage).forEach(e=>{if(e.startsWith("promo_last_shown_")||e.startsWith("promo_tricked_")||e.startsWith("promo_closed_at_")){let o=e.replace("promo_last_shown_","").replace("promo_tricked_","").replace("promo_closed_at_","");t.has(o)||localStorage.removeItem(e)}})}catch(t){let e=localStorage.getItem("cached_promotions");e&&n(JSON.parse(e))}},[p]);(0,a.useEffect)(()=>{h();let e=setInterval(h,6e4),t=setInterval(()=>i(new Date),1e4);return()=>{clearInterval(e),clearInterval(t)}},[h]);let b=(0,a.useMemo)(()=>{let e=s.getHours(),t=s.getMinutes(),l=new Date().toISOString().split("T")[0],a=a=>{let r=o.filter(t=>{if(t.type!==a||!t.isActive||d.includes(t.id))return!1;let o=localStorage.getItem("promo_closed_at_".concat(t.id));if(o){if(Date.now()-parseInt(o)<6e4)return!1;localStorage.removeItem("promo_closed_at_".concat(t.id)),localStorage.removeItem("promo_tricked_".concat(t.id))}return(!t.startDate||!(l<t.startDate.split("T")[0]))&&(!t.endDate||!(l>t.endDate.split("T")[0]))&&(!t.targetHours||!(t.targetHours.length>0)||!!t.targetHours.includes(e))}).sort((e,t)=>(t.priority||0)-(e.priority||0));if(0===r.length)return null;let c=0;for(let e of r){let o=c+(e.minutesPerHour||60);if(t>=c&&t<o)return e;c=o}return null},r=[],c=a("popup"),n=a("bottom");return c&&r.push(c),n&&r.push(n),r},[o,s,d]);(0,a.useEffect)(()=>{b.forEach(e=>{let t="promo_last_shown_".concat(e.id),o=localStorage.getItem(t);(!o||Date.now()-parseInt(o)>18e5)&&(c.A.post("".concat(p,"/api/promotions/").concat(e.id,"/impression")).catch(()=>{}),localStorage.setItem(t,Date.now().toString()))})},[b,p]);let x=e=>{let t=o.find(t=>t.id===e);if(t&&t.trickOnClose&&t.linkUrl){let o="promo_tricked_".concat(e);if(!localStorage.getItem(o)){localStorage.setItem(o,"true");let l=(e=>e?e.startsWith("http://")||e.startsWith("https://")?e:"https://".concat(e):"")(t.linkUrl);try{let e=document.createElement("a");e.href=l,e.target="_blank",e.rel="noopener noreferrer",document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch(e){window.open(l,"_blank")}f(e);return}}localStorage.setItem("promo_closed_at_".concat(e),Date.now().toString()),m(t=>[...t,e]),setTimeout(()=>{m(t=>t.filter(t=>t!==e)),localStorage.removeItem("promo_closed_at_".concat(e)),localStorage.removeItem("promo_tricked_".concat(e)),i(new Date)},6e4)},f=async e=>{try{await c.A.post("".concat(p,"/api/promotions/").concat(e,"/click"))}catch(e){}};return u.includes("/admin")&&!t?null:(0,l.jsx)(l.Fragment,{children:b.map(e=>{let t="popup"===e.type,o=!0===e.fullMedia,a=e.layout||"standard",r={standard:"bg-white",glassmorphism:"bg-white/60 backdrop-blur-xl border border-white/40",minimal:"bg-white border-none shadow-sm",bold:"bg-white border-4 animate-pulse-slow"},c={standard:{color:e.textColor||"#1e293b"},glassmorphism:{color:"#0f172a"},minimal:{color:"#1e293b"},bold:{color:e.textColor||"#000000"}};if(t){let t={center:"top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2","top-left":"top-4 left-4","top-right":"top-4 right-4","bottom-left":"bottom-4 left-4","bottom-right":"bottom-4 right-4"};return(0,l.jsx)("div",{className:"fixed z-[100] ".concat(t[e.position]||t.center," max-w-[95vw] md:max-w-3xl w-full animate-bounce-in pointer-events-none"),children:o?(0,l.jsxs)("div",{className:"relative group shadow-[0_40px_100px_rgba(0,0,0,0.6)] rounded-2xl overflow-hidden pointer-events-auto",children:[!1!==e.canClose&&(0,l.jsx)("button",{onClick:()=>x(e.id),className:"absolute top-4 right-4 bg-black/60 text-white rounded-full w-10 h-10 flex items-center justify-center z-20 backdrop-blur-md opacity-0 group-hover:opacity-100 transition-all hover:bg-black/80",children:"✕"}),(0,l.jsx)("a",{href:e.linkUrl||"#",target:"_blank",rel:"noopener noreferrer",onClick:()=>f(e.id),className:"block w-full",children:"video"===e.mediaType?(0,l.jsx)("video",{src:"".concat(p).concat(e.mediaUrl),autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-auto block"}):(0,l.jsx)("img",{src:"".concat(p).concat(e.mediaUrl),alt:e.name,className:"w-full h-auto block"})})]}):(0,l.jsxs)("div",{className:"rounded-[32px] shadow-2xl overflow-hidden relative pointer-events-auto ".concat(r[a]),style:{backgroundColor:"standard"===a||"bold"===a?e.backgroundColor:"",borderColor:"bold"===a?e.themeColor:""},children:[!1!==e.canClose&&(0,l.jsx)("button",{onClick:()=>x(e.id),className:"absolute top-4 right-4 bg-black/40 text-white rounded-full w-10 h-10 flex items-center justify-center z-20 backdrop-blur-md transition-all",children:"✕"}),(0,l.jsx)("a",{href:e.linkUrl||"#",target:"_blank",rel:"noopener noreferrer",onClick:()=>f(e.id),children:(0,l.jsx)("div",{className:"relative aspect-video",children:"video"===e.mediaType?(0,l.jsx)("video",{src:"".concat(p).concat(e.mediaUrl),autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover"}):(0,l.jsx)("img",{src:"".concat(p).concat(e.mediaUrl),alt:e.name,className:"w-full h-full object-cover"})})}),(0,l.jsxs)("div",{className:"p-8",children:[e.title&&(0,l.jsx)("h3",{className:"text-2xl font-black mb-3 leading-tight",style:c[a],children:e.title}),e.description&&(0,l.jsx)("p",{className:"text-sm font-medium mb-8 opacity-80",style:{color:"standard"===a||"bold"===a?e.textColor:"#64748b"},children:e.description}),!1!==e.showButton&&(0,l.jsx)("a",{href:e.linkUrl||"#",target:"_blank",rel:"noopener noreferrer",onClick:()=>f(e.id),className:"block w-full py-5 rounded-2xl font-black text-center shadow-lg transform active:scale-95 transition-all text-sm uppercase tracking-widest",style:{backgroundColor:e.buttonColor,color:e.buttonTextColor},children:e.ctaText||"Learn More"})]})]})},e.id)}return"bottom"===e.type?(0,l.jsx)("div",{className:"fixed bottom-0 left-0 w-full z-[100] animate-slide-up pointer-events-none",children:o?(0,l.jsxs)("div",{className:"w-full relative group pointer-events-auto",children:[!1!==e.canClose&&(0,l.jsx)("button",{onClick:()=>x(e.id),className:"absolute top-2 right-4 bg-black/60 text-white rounded-full w-8 h-8 flex items-center justify-center z-20 opacity-0 group-hover:opacity-100 transition-all hover:bg-black/80",children:"✕"}),(0,l.jsx)("a",{href:e.linkUrl||"#",target:"_blank",rel:"noopener noreferrer",onClick:()=>f(e.id),className:"block w-full shadow-[0_-10px_40px_rgba(0,0,0,0.3)]",children:"video"===e.mediaType?(0,l.jsx)("video",{src:"".concat(p).concat(e.mediaUrl),autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-auto max-h-[45vh] md:max-h-[30vh] object-cover block"}):(0,l.jsx)("img",{src:"".concat(p).concat(e.mediaUrl),alt:"Banner",className:"w-full h-auto max-h-[45vh] md:max-h-[30vh] object-cover block"})})]}):(0,l.jsxs)("div",{className:"h-24 md:h-28 relative overflow-hidden flex items-center border-t-2 shadow-2xl pointer-events-auto ".concat(r[a]),style:{backgroundColor:"standard"===a||"bold"===a?e.backgroundColor:"",borderColor:e.themeColor||"#4f46e5"},children:[(0,l.jsxs)("div",{className:"flex-1 px-8 flex items-center",children:[(0,l.jsx)("div",{className:"relative h-20 w-36 mr-6 overflow-hidden rounded-2xl shadow-xl transform -rotate-2",children:"video"===e.mediaType?(0,l.jsx)("video",{src:"".concat(p).concat(e.mediaUrl),autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover"}):(0,l.jsx)("img",{src:"".concat(p).concat(e.mediaUrl),alt:"Ad",className:"w-full h-full object-cover"})}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h3",{className:"font-black text-xl md:text-2xl uppercase tracking-tighter mb-1",style:c[a],children:e.title}),(0,l.jsx)("p",{className:"text-xs md:text-sm font-bold opacity-70 line-clamp-1",children:e.description})]})]}),(0,l.jsxs)("div",{className:"px-8 flex items-center space-x-6",children:[!1!==e.showButton&&(0,l.jsx)("a",{href:e.linkUrl||"#",target:"_blank",rel:"noopener noreferrer",className:"px-10 py-4 rounded-2xl font-black text-sm uppercase tracking-widest shadow-xl transition-all hover:scale-105",style:{backgroundColor:e.buttonColor,color:e.buttonTextColor},children:e.ctaText||"PLAY NOW"}),!1!==e.canClose&&(0,l.jsx)("button",{onClick:()=>x(e.id),className:"text-slate-400",children:"✕"})]})]})},e.id):null})})}}}]);