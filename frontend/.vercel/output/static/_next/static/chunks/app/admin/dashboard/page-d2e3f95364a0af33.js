(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[957],{3400:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var a=s(5155),l=s(2115),i=s(63),n=s(5125),r=s(5239),o=s(8515),d=s(5704);let c=e=>{let{campaign:t,onClose:s,mediaPreview:l}=e;return t?(0,a.jsx)("div",{className:"fixed inset-0 z-[60] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("h3",{className:"text-2xl font-bold text-slate-800",children:["Preview: ",(0,a.jsx)("span",{className:"text-indigo-600",children:t.name})]}),(0,a.jsx)("button",{onClick:s,className:"p-2 hover:bg-slate-100 rounded-full transition-colors",children:(0,a.jsx)("span",{className:"text-2xl",children:"\xd7"})})]}),(0,a.jsxs)("div",{className:"relative w-full h-[600px] border-4 border-slate-900 rounded-2xl overflow-hidden bg-slate-50 shadow-inner",children:[(0,a.jsxs)("div",{className:"absolute inset-0 p-8 opacity-20 pointer-events-none",children:[(0,a.jsx)("div",{className:"h-8 bg-slate-300 w-1/3 mb-8 rounded"}),(0,a.jsx)("div",{className:"h-4 bg-slate-300 w-full mb-4 rounded"}),(0,a.jsx)("div",{className:"h-4 bg-slate-300 w-full mb-4 rounded"}),(0,a.jsx)("div",{className:"h-4 bg-slate-300 w-2/3 mb-12 rounded"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)("div",{className:"h-40 bg-slate-200 rounded"}),(0,a.jsx)("div",{className:"h-40 bg-slate-200 rounded"})]})]}),(0,a.jsxs)("div",{className:"absolute ".concat("bottom"===t.type?"bottom-0 left-0 w-full":"center"===t.position?"top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2":""," ").concat("top-left"===t.position?"top-4 left-4":""," ").concat("top-right"===t.position?"top-4 right-4":""," ").concat("bottom-left"===t.position?"bottom-4 left-4":""," ").concat("bottom-right"===t.position?"bottom-4 right-4":""," transition-all duration-500"),children:["popup"===t.type&&(0,a.jsxs)("div",{className:"bg-white p-4 rounded-xl shadow-2xl max-w-xs relative animate-bounce-in",children:[!1!==t.canClose&&(0,a.jsx)("button",{className:"absolute -top-2 -right-2 bg-black text-white rounded-full w-6 h-6 flex items-center justify-center text-xs",children:"✕"}),"video"===t.mediaType?(0,a.jsx)("video",{src:l,autoPlay:!0,loop:!0,muted:!0,className:"w-full rounded-lg mb-2"}):(0,a.jsx)(r.default,{src:l,alt:"Ad",width:400,height:400,className:"w-full rounded-lg mb-2 object-cover",unoptimized:!0}),!1!==t.showButton&&(0,a.jsx)("a",{href:"#",className:"block w-full bg-indigo-600 text-white text-center py-2 rounded-lg font-bold text-sm mt-2",children:t.ctaText||"Learn More"})]}),"bottom"===t.type&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 w-full z-[100] bg-gradient-to-r from-slate-900 via-purple-900 to-slate-900 border-t-2 border-indigo-500 shadow-[0_-10px_40px_rgba(79,70,229,0.3)]",children:(0,a.jsx)("div",{className:"flex items-center justify-between ".concat(t.fullMedia?"h-24":"h-20 px-4"," relative overflow-hidden"),children:t.fullMedia?(0,a.jsxs)("div",{className:"absolute inset-0 w-full h-full",children:["video"===t.mediaType?(0,a.jsx)("video",{src:l,autoPlay:!0,loop:!0,muted:!0,className:"w-full h-full object-cover"}):(0,a.jsx)(r.default,{src:l,alt:"Ad",fill:!0,className:"object-cover",unoptimized:!0}),!1!==t.canClose&&(0,a.jsx)("button",{className:"absolute top-2 right-2 w-8 h-8 flex items-center justify-center bg-black/50 rounded-full text-white text-sm z-30",children:"✕"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-white/5 opacity-20 bg-[length:4px_4px]"}),(0,a.jsx)("div",{className:"absolute top-0 left-1/4 w-32 h-full bg-white/5 skew-x-[-20deg] blur-xl"}),(0,a.jsxs)("div",{className:"flex items-center h-full flex-1",children:[(0,a.jsx)("div",{className:"relative h-16 aspect-[16/9] mr-4 overflow-hidden -skew-x-12 border-r-2 border-indigo-500/50",children:"video"===t.mediaType?(0,a.jsx)("video",{src:l,autoPlay:!0,loop:!0,muted:!0,className:"w-full h-full object-cover skew-x-12 scale-110"}):(0,a.jsx)(r.default,{src:l,alt:"Ad",fill:!0,className:"object-cover skew-x-12 scale-110",unoptimized:!0})}),(0,a.jsxs)("div",{className:"z-10",children:[(0,a.jsx)("h3",{className:"font-black text-white text-lg italic tracking-wider uppercase drop-shadow",children:(0,a.jsx)("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 to-yellow-500",children:t.name||"Campaign"})}),(0,a.jsx)("p",{className:"text-[10px] text-indigo-200 font-bold tracking-wide uppercase",children:"Limited Time Offer"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[!1!==t.showButton&&(0,a.jsx)("button",{className:"px-6 py-2 bg-gradient-to-r from-yellow-400 to-yellow-600 text-slate-900 font-black text-sm uppercase italic tracking-widest -skew-x-12 border-2 border-yellow-200 shadow-lg glow",children:(0,a.jsx)("span",{className:"skew-x-12",children:t.ctaText||"Play Now"})}),!1!==t.canClose&&(0,a.jsx)("button",{className:"w-6 h-6 flex items-center justify-center bg-white/10 rounded-full text-white/50 text-xs",children:"✕"})]})]})})})]})]}),(0,a.jsx)("p",{className:"text-center text-slate-400 text-xs mt-4",children:"* This is a simulated preview. Actual rendering may vary slightly based on screen size."})]})}):null},x=()=>{let[e,t]=(0,l.useState)([]),[s,i]=(0,l.useState)(!0),[o,x]=(0,l.useState)(!1),[m,u]=(0,l.useState)(null),[h,p]=(0,l.useState)(null),[g,b]=(0,l.useState)({name:"",type:"popup",mediaType:"image",linkUrl:"",displayDuration:5,frequency:60,frequencyUnit:"minutes",position:"center",isActive:!0,canClose:!0,fullMedia:!1,priority:0,ctaText:"PLAY NOW",showButton:!0,startDate:"",endDate:""}),[f,j]=(0,l.useState)(null),[v,y]=(0,l.useState)(""),N=d.env.NEXT_PUBLIC_API_URL||"https://umutoza-umutoza.hf.space",w=(0,l.useRef)(null),k=(0,l.useCallback)(async()=>{try{localStorage.getItem("adminToken");let e=await n.A.get("".concat(N,"/api/promotions"),{});t(e.data),i(!1)}catch(e){console.error("Error fetching campaigns:",e),i(!1)}},[N]);(0,l.useEffect)(()=>{(async()=>{await k()})()},[k]);let C=e=>{let{name:t,value:s,type:a,checked:l}=e.target,i="checkbox"===a?l:s;"number"===a&&(i=""===s?"":Number(s)),b(e=>({...e,[t]:i}))},D=()=>{b({name:"",type:"popup",mediaType:"image",linkUrl:"",displayDuration:5,frequency:60,frequencyUnit:"minutes",position:"center",isActive:!0,canClose:!0,fullMedia:!1,priority:0,ctaText:"PLAY NOW",showButton:!0,startDate:"",endDate:""}),j(null),y(""),u(null),w.current&&(w.current.value="")},A=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?(u(e),b({name:e.name||"",type:e.type||"popup",mediaType:e.mediaType||"image",linkUrl:e.linkUrl||"",displayDuration:void 0!==e.displayDuration?e.displayDuration:5,frequency:void 0!==e.frequency?e.frequency:60,frequencyUnit:e.frequencyUnit||"minutes",position:e.position||"center",isActive:void 0===e.isActive||e.isActive,canClose:void 0===e.canClose||e.canClose,fullMedia:e.fullMedia||!1,priority:void 0!==e.priority?e.priority:0,ctaText:e.ctaText||"PLAY NOW",showButton:void 0===e.showButton||e.showButton,startDate:e.startDate?e.startDate.split("T")[0]:"",endDate:e.endDate?e.endDate.split("T")[0]:""}),y("".concat(N).concat(e.mediaUrl))):D(),x(!0)},T=async e=>{e.preventDefault();let t=new FormData;Object.keys(g).forEach(e=>{t.append(e,g[e])}),f&&t.append("media",f);try{m?await n.A.put("".concat(N,"/api/promotions/").concat(m.id),t,{headers:{"Content-Type":"multipart/form-data"}}):await n.A.post("".concat(N,"/api/promotions"),t,{headers:{"Content-Type":"multipart/form-data"}}),k(),x(!1),D()}catch(e){console.error("Error saving campaign:",e),alert("Failed to save campaign")}},S=async e=>{if(window.confirm("Are you sure you want to delete this campaign?"))try{await n.A.delete("".concat(N,"/api/promotions/").concat(e)),k()}catch(e){console.error("Error deleting campaign:",e)}},z=async e=>{try{await n.A.patch("".concat(N,"/api/promotions/").concat(e,"/toggle")),k()}catch(e){console.error("Error toggling status:",e)}};return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-black text-slate-800",children:"Campaigns"}),(0,a.jsx)("p",{className:"text-slate-500",children:"Manage placement, duration, and media."})]}),(0,a.jsx)("button",{onClick:()=>A(),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-xl font-bold shadow-lg shadow-indigo-200 transition-all flex items-center space-x-2",children:(0,a.jsx)("span",{children:"+ New Campaign"})})]}),s?(0,a.jsx)("div",{className:"flex justify-center py-20",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-2xl border ".concat(e.isActive?"border-indigo-100":"border-slate-100 bg-slate-50"," shadow-sm hover:shadow-xl transition-all p-5 group"),children:[(0,a.jsxs)("div",{className:"relative aspect-video rounded-xl overflow-hidden bg-slate-100 mb-4 cursor-pointer",onClick:()=>{u(e),y("".concat(N).concat(e.mediaUrl)),p(e)},children:["video"===e.mediaType?(0,a.jsx)("video",{src:"".concat(N).concat(e.mediaUrl),className:"w-full h-full object-cover"}):(0,a.jsx)(r.default,{src:"".concat(N).concat(e.mediaUrl),alt:e.name,fill:!0,className:"object-cover",unoptimized:!0}),(0,a.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-all flex items-center justify-center opacity-0 group-hover:opacity-100",children:(0,a.jsx)("span",{className:"bg-white/90 text-slate-900 px-3 py-1 rounded-full text-xs font-bold",children:"Preview"})})]}),(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-slate-900",children:e.name}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,a.jsx)("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-600 rounded text-[10px] font-bold uppercase",children:e.type}),(0,a.jsxs)("span",{className:"px-2 py-0.5 bg-indigo-100 text-indigo-700 rounded text-[10px] font-bold uppercase",children:["Prio: ",e.priority||0]})]})]}),(0,a.jsx)("div",{className:"flex space-x-2",children:(0,a.jsx)("button",{onClick:()=>z(e.id),className:"w-8 h-8 rounded-full flex items-center justify-center transition-colors ".concat(e.isActive?"bg-green-100 text-green-600":"bg-slate-200 text-slate-400"),children:e.isActive?"✓":"✕"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-4 pt-4 border-t border-slate-100 text-xs text-slate-500",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"block font-bold text-slate-700",children:e.impressions||0}),"Views"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"block font-bold text-slate-700",children:e.clicks||0}),"Clicks"]}),(0,a.jsxs)("div",{className:"col-span-2 mt-2 pt-2 border-t border-slate-50 italic",children:[e.startDate?new Date(e.startDate).toLocaleDateString():"Immediate",e.endDate?" → ".concat(new Date(e.endDate).toLocaleDateString()):" (No expiry)"]})]}),(0,a.jsxs)("div",{className:"mt-4 flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>A(e),className:"flex-1 bg-indigo-50 text-indigo-600 py-2 rounded-lg text-xs font-bold hover:bg-indigo-100 transition-colors",children:"Edit"}),(0,a.jsx)("button",{onClick:()=>S(e.id),className:"flex-1 bg-red-50 text-red-500 py-2 rounded-lg text-xs font-bold hover:bg-red-100 transition-colors",children:"Delete"})]})]},e.id)),0===e.length&&(0,a.jsx)("div",{className:"col-span-full py-20 text-center text-slate-400",children:"No campaigns created yet. Start a new one!"})]}),o&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-center justify-center p-4 overflow-y-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[(0,a.jsxs)("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[(0,a.jsx)("h3",{className:"font-bold text-xl text-gray-800",children:m?"Edit Campaign":"New Campaign"}),(0,a.jsx)("button",{onClick:()=>x(!1),className:"w-8 h-8 rounded-full bg-white text-gray-400 hover:text-red-500 flex items-center justify-center shadow-sm transition-all",children:"✕"})]}),(0,a.jsx)("div",{className:"p-8 overflow-y-auto",children:(0,a.jsxs)("form",{onSubmit:T,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Campaign Name"}),(0,a.jsx)("input",{name:"name",value:g.name,onChange:C,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-50 transition-all font-medium",placeholder:"e.g. Summer Sale 2026",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Type"}),(0,a.jsxs)("select",{name:"type",value:g.type,onChange:C,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-50 transition-all bg-white font-medium",children:[(0,a.jsx)("option",{value:"popup",children:"Popup / Modal"}),(0,a.jsx)("option",{value:"bottom",children:"Bottom Sticky Bar"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Screen Position"}),(0,a.jsxs)("select",{name:"position",value:g.position,onChange:C,disabled:"bottom"===g.type,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-50 transition-all bg-white font-medium disabled:opacity-50",children:[(0,a.jsx)("option",{value:"center",children:"Center (Standard)"}),(0,a.jsx)("option",{value:"top-left",children:"Top Left"}),(0,a.jsx)("option",{value:"top-right",children:"Top Right"}),(0,a.jsx)("option",{value:"bottom-left",children:"Bottom Left"}),(0,a.jsx)("option",{value:"bottom-right",children:"Bottom Right"})]})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Media File (Image, GIF, Video)"}),(0,a.jsxs)("div",{className:"border-2 border-dashed border-indigo-100 rounded-xl p-8 text-center hover:bg-indigo-50 transition-colors cursor-pointer relative group",children:[(0,a.jsx)("input",{type:"file",ref:w,onChange:e=>{let t=e.target.files[0];if(t){j(t);let e=new FileReader;e.onloadend=()=>{y(e.result)},e.readAsDataURL(t)}},accept:"image/*,video/*",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),v?(0,a.jsxs)("div",{className:"relative inline-block",children:["video"===g.mediaType||f&&f.type.startsWith("video")?(0,a.jsx)("video",{src:v,className:"h-32 rounded-lg shadow-md",autoPlay:!0,muted:!0,loop:!0}):(0,a.jsx)(r.default,{src:v,width:200,height:128,className:"h-32 w-auto rounded-lg shadow-md object-contain",alt:"Preview",unoptimized:!0}),(0,a.jsx)("p",{className:"text-xs text-indigo-600 font-bold mt-2",children:"Click to replace"})]}):(0,a.jsxs)("div",{className:"text-gray-400",children:[(0,a.jsx)("span",{className:"text-2xl block mb-2",children:"\uD83D\uDCC1"}),(0,a.jsx)("span",{className:"font-bold text-sm",children:"Drag & Drop or Click to Upload"}),(0,a.jsx)("p",{className:"text-xs mt-1",children:"Supports JPG, PNG, GIF, MP4"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Display Duration (sec)"}),(0,a.jsx)("input",{type:"number",name:"displayDuration",value:g.displayDuration,onChange:C,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-50 transition-all font-medium"}),(0,a.jsx)("p",{className:"text-[10px] text-gray-400 mt-1",children:"Popup stay time. 0 = permanent."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Display Priority"}),(0,a.jsx)("input",{type:"number",name:"priority",value:g.priority,onChange:C,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-50 transition-all font-medium"}),(0,a.jsx)("p",{className:"text-[10px] text-gray-400 mt-1",children:"Higher shows first (e.g. 10 vs 1)."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Show Every"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("input",{type:"number",name:"frequency",value:g.frequency,onChange:C,className:"w-20 px-4 py-3 rounded-xl border border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-50 transition-all font-medium"}),(0,a.jsxs)("select",{name:"frequencyUnit",value:g.frequencyUnit,onChange:C,className:"flex-1 px-4 py-3 rounded-xl border border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-50 transition-all bg-white font-medium",children:[(0,a.jsx)("option",{value:"minutes",children:"Minutes"}),(0,a.jsx)("option",{value:"hours",children:"Hours"}),(0,a.jsx)("option",{value:"days",children:"Days"})]})]})]}),(0,a.jsxs)("div",{className:"col-span-2 grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Destination URL"}),(0,a.jsx)("input",{name:"linkUrl",value:g.linkUrl,onChange:C,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-50 transition-all font-medium",placeholder:"https://"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Button Text"}),(0,a.jsx)("input",{name:"ctaText",value:g.ctaText,onChange:C,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-50 transition-all font-medium",placeholder:"PLAY NOW"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 col-span-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Start Date (Optional)"}),(0,a.jsx)("input",{type:"date",name:"startDate",value:g.startDate,onChange:C,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-50 transition-all font-medium"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"End Date (Optional)"}),(0,a.jsx)("input",{type:"date",name:"endDate",value:g.endDate,onChange:C,className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-50 transition-all font-medium"})]})]}),(0,a.jsxs)("div",{className:"col-span-2 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 bg-indigo-50 p-4 rounded-xl border border-indigo-100",children:[(0,a.jsx)("input",{type:"checkbox",id:"canClose",name:"canClose",checked:g.canClose,onChange:C,className:"w-5 h-5 text-indigo-600 rounded focus:ring-indigo-500"}),(0,a.jsx)("label",{htmlFor:"canClose",className:"text-sm font-bold text-indigo-900",children:"Allow users to close this ad manually"})]}),"bottom"===g.type&&(0,a.jsxs)("div",{className:"flex items-center space-x-3 bg-indigo-50 p-4 rounded-xl border border-indigo-100",children:[(0,a.jsx)("input",{type:"checkbox",id:"fullMedia",name:"fullMedia",checked:g.fullMedia,onChange:C,className:"w-5 h-5 text-indigo-600 rounded focus:ring-indigo-500"}),(0,a.jsx)("label",{htmlFor:"fullMedia",className:"text-sm font-bold text-indigo-900",children:"Full Image Banner & Entire Bar Clickable"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3 bg-slate-50 p-4 rounded-xl border border-slate-200",children:[(0,a.jsx)("input",{type:"checkbox",id:"showButton",name:"showButton",checked:g.showButton,onChange:C,className:"w-5 h-5 text-slate-600 rounded focus:ring-slate-500"}),(0,a.jsx)("label",{htmlFor:"showButton",className:"text-sm font-bold text-slate-700",children:"Display Action Button (e.g. Play Now)"})]})]})]}),(0,a.jsxs)("div",{className:"pt-6 flex justify-end space-x-4 border-t border-gray-100",children:[(0,a.jsx)("button",{type:"button",onClick:()=>x(!1),className:"px-6 py-3 rounded-xl font-bold text-gray-500 hover:bg-gray-100 transition-colors",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-8 py-3 rounded-xl font-bold text-white bg-indigo-600 hover:bg-indigo-700 shadow-lg shadow-indigo-200 transform hover:scale-105 transition-all",children:m?"Save Changes":"Launch Campaign"})]})]})})]})}),h&&(0,a.jsx)(c,{campaign:g.name?g:h,onClose:()=>p(null),mediaPreview:v})]})};var m=s(5704);let u=()=>{let[e,t]=(0,l.useState)([]),[s,i]=(0,l.useState)(!0),r=m.env.NEXT_PUBLIC_API_URL||"https://umutoza-umutoza.hf.space",o=localStorage.getItem("adminToken"),d=(0,l.useCallback)(async()=>{try{let e=await n.A.get("".concat(r,"/api/messages"),{headers:{Authorization:"Bearer ".concat(o)}});t(e.data),i(!1)}catch(e){console.error("Error fetching messages:",e),i(!1)}},[r,o]);(0,l.useEffect)(()=>{(async()=>{await d()})()},[d]);let c=async e=>{try{await n.A.put("".concat(r,"/api/messages/").concat(e,"/read"),{},{headers:{Authorization:"Bearer ".concat(o)}}),d()}catch(e){console.error("Error marking message as read:",e)}},x=async e=>{if(window.confirm("Ese wizeye ko ushaka gusiba ubu butumwa?"))try{await n.A.delete("".concat(r,"/api/messages/").concat(e),{headers:{Authorization:"Bearer ".concat(o)}}),d()}catch(e){console.error("Error deleting message:",e)}};return s?(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-600"})}):(0,a.jsxs)("div",{className:"p-4 md:p-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-black text-slate-900",children:"Ubutumwa bwakiriwe"}),(0,a.jsxs)("div",{className:"bg-indigo-100 text-indigo-600 px-4 py-1 rounded-full text-sm font-bold",children:[e.length," Ubwose"]})]}),0===e.length?(0,a.jsxs)("div",{className:"text-center py-20 bg-slate-50 rounded-[30px] border-2 border-dashed border-slate-200",children:[(0,a.jsx)("span",{className:"text-5xl block mb-4",children:"\uD83D\uDCE9"}),(0,a.jsx)("h3",{className:"text-xl font-bold text-slate-400",children:"Nta butumwa buraboneka"})]}):(0,a.jsx)("div",{className:"grid gap-6",children:e.map(e=>(0,a.jsxs)("div",{className:"bg-white p-6 rounded-[25px] shadow-sm border-l-4 transition-all hover:shadow-md ".concat("unread"===e.status?"border-indigo-500":"border-slate-200"),children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-lg text-slate-900",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-indigo-600 font-medium",children:e.email}),(0,a.jsx)("p",{className:"text-[10px] text-slate-400 uppercase font-bold mt-1",children:new Date(e.createdAt).toLocaleString()})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:["unread"===e.status&&(0,a.jsx)("button",{onClick:()=>c(e._id),className:"p-2 bg-indigo-50 text-indigo-600 rounded-xl hover:bg-indigo-100 transition-colors",title:"Mark as read",children:"✓"}),(0,a.jsx)("button",{onClick:()=>x(e._id),className:"p-2 bg-red-50 text-red-500 rounded-xl hover:bg-red-100 transition-colors",title:"Delete",children:"✕"})]})]}),(0,a.jsx)("div",{className:"bg-slate-50 p-4 rounded-2xl text-slate-700 leading-relaxed",children:e.message})]},e._id))})]})};var h=s(5704);let p=e=>{let{active:t,label:s,icon:l,onClick:i,count:n}=e;return(0,a.jsxs)("button",{onClick:i,className:"\n      flex items-center space-x-2 px-6 py-3 rounded-full text-sm font-bold transition-all\n      ".concat(t?"bg-indigo-600 text-white shadow-lg shadow-indigo-200":"text-slate-500 hover:bg-slate-100 hover:text-indigo-600","\n    "),children:[(0,a.jsx)("span",{children:l}),(0,a.jsx)("span",{children:s}),void 0!==n&&(0,a.jsx)("span",{className:"ml-2 px-2 py-0.5 rounded-full text-[10px] ".concat(t?"bg-white/20 text-white":"bg-slate-200 text-slate-600"),children:n})]})},g=e=>{var t,s;let{session:l,onDelete:i,currentTime:n}=e;l.status;let r=n-new Date(l.lastActive)<12e3;return(0,a.jsxs)("div",{className:"bg-white rounded-[24px] border border-slate-100 shadow-sm hover:shadow-xl transition-all p-6 group relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute top-0 left-0 w-full h-1 ".concat(r?"bg-green-500 animate-pulse":"bg-slate-200")}),(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-2xl flex items-center justify-center text-lg font-black shadow-sm ".concat(r?"bg-green-50 text-green-600":"bg-slate-100 text-slate-400"),children:(null==(s=l.userName)||null==(t=s[0])?void 0:t.toUpperCase())||"?"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold text-slate-900 leading-tight",children:l.userName||"Anonymous"}),(0,a.jsxs)("div",{className:"flex flex-col space-y-1 mt-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"w-2 h-2 rounded-full ".concat(r?"bg-green-500 animate-ping":"bg-slate-300")}),(0,a.jsx)("p",{className:"text-[10px] font-black uppercase tracking-wider text-slate-500",children:r?(0,a.jsx)("span",{className:"text-green-600 font-bold",children:"Online"}):(0,a.jsx)("span",{className:"text-slate-400",children:"Offline"})})]}),r&&l.activity&&(0,a.jsxs)("p",{className:"text-[10px] font-bold text-indigo-500 bg-indigo-50 px-2 py-0.5 rounded-md inline-block",children:["\uD83D\uDCCD ",l.activity]})]})]})]}),(0,a.jsx)("button",{onClick:()=>i(l.id),className:"w-8 h-8 rounded-full flex items-center justify-center text-slate-300 hover:bg-red-50 hover:text-red-500 transition-colors",children:"✕"})]})]})},b=e=>{let{message:t,sub:s}=e;return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[(0,a.jsx)("div",{className:"w-24 h-24 bg-slate-50 rounded-full flex items-center justify-center text-4xl mb-6 text-slate-300",children:"∅"}),(0,a.jsx)("h3",{className:"text-slate-900 font-bold text-lg mb-2",children:t}),(0,a.jsx)("p",{className:"text-slate-400 text-sm max-w-xs mx-auto",children:s})]})},f=()=>{let[e,t]=(0,l.useState)("live"),[s,d]=(0,l.useState)([]),[c,m]=(0,l.useState)([]),[f,j]=(0,l.useState)(!0),[v,y]=(0,l.useState)(new Date),N=(0,i.useRouter)(),w=(0,l.useRef)(!0),k=h.env.NEXT_PUBLIC_API_URL||"https://umutoza-umutoza.hf.space",C=localStorage.getItem("adminToken"),D=(0,l.useCallback)(async()=>{if(C)try{let[e,t]=await Promise.all([n.A.get("".concat(k,"/api/admin/quiz")).catch(()=>({data:[]})),n.A.get("".concat(k,"/api/sessions"),{headers:{Authorization:"Bearer ".concat(C)}}).catch(()=>({data:[]}))]);w.current&&(d(Array.isArray(e.data)?e.data:[]),m(Array.isArray(t.data)?t.data:[]),j(!1))}catch(e){console.error(e)}},[k,C]);(0,l.useEffect)(()=>{if(w.current=!0,!C)return void N.push("/admin/login");(async()=>{await D()})();let e=setInterval(D,3e3),t=setInterval(()=>y(new Date),1e3);return()=>{w.current=!1,clearInterval(e),clearInterval(t)}},[C,N,D]);let A=c.filter(e=>"active"===e.status),T=c.filter(e=>"completed"===e.status),S=async e=>{if(window.confirm("Delete this session?"))try{await n.A.delete("".concat(k,"/api/sessions/").concat(e),{headers:{Authorization:"Bearer ".concat(C)}}),D()}catch(e){alert("Error deleting")}};return(0,a.jsxs)("div",{className:"min-h-screen bg-[#F8F9FC] font-sans text-slate-600 selection:bg-indigo-100 selection:text-indigo-900",children:[(0,a.jsxs)("nav",{className:"fixed left-0 top-0 h-full w-20 bg-white border-r border-slate-100 flex flex-col items-center py-8 z-50 shadow-[4px_0_24px_rgba(0,0,0,0.02)]",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center text-white font-black text-xl mb-12 shadow-indigo-200 shadow-lg",children:"U"}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col space-y-8 w-full items-center",children:[(0,a.jsx)("button",{onClick:()=>t("live"),className:"w-10 h-10 rounded-xl flex items-center justify-center transition-all ".concat("live"===e?"bg-indigo-50 text-indigo-600":"text-slate-400 hover:bg-slate-50 hover:text-slate-600"),children:(0,a.jsx)("span",{className:"text-xl",children:"⚡"})}),(0,a.jsx)("button",{onClick:()=>t("questions"),className:"w-10 h-10 rounded-xl flex items-center justify-center transition-all ".concat("questions"===e?"bg-indigo-50 text-indigo-600":"text-slate-400 hover:bg-slate-50 hover:text-slate-600"),children:(0,a.jsx)("span",{className:"text-xl",children:"\uD83D\uDCDA"})}),(0,a.jsx)("button",{onClick:()=>t("campaigns"),className:"w-10 h-10 rounded-xl flex items-center justify-center transition-all ".concat("campaigns"===e?"bg-indigo-50 text-indigo-600":"text-slate-400 hover:bg-slate-50 hover:text-slate-600"),children:(0,a.jsx)("span",{className:"text-xl",children:"\uD83D\uDCE2"})}),(0,a.jsx)("button",{onClick:()=>t("messages"),className:"w-10 h-10 rounded-xl flex items-center justify-center transition-all ".concat("messages"===e?"bg-indigo-50 text-indigo-600":"text-slate-400 hover:bg-slate-50 hover:text-slate-600"),children:(0,a.jsx)("span",{className:"text-xl",children:"\uD83D\uDCE9"})})]}),(0,a.jsx)("button",{onClick:()=>{localStorage.removeItem("adminToken"),N.push("/admin/login")},className:"w-10 h-10 rounded-xl flex items-center justify-center text-slate-300 hover:text-red-500 transition-all",children:(0,a.jsx)("span",{className:"text-xl",children:"↪"})})]}),(0,a.jsxs)("main",{className:"pl-20 min-h-screen",children:[(0,a.jsxs)("header",{className:"px-12 py-8 flex items-center justify-between bg-white/80 backdrop-blur-md sticky top-0 z-40 border-b border-indigo-50/50",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-black text-slate-900 tracking-tight",children:"live"===e?"Abariho ubu":"questions"===e?"Ibibazo":"campaigns"===e?"Kwamamaza":"Ubutumwa"}),(0,a.jsx)("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mt-1",children:"live"===e?"Gukurikirana abakoresha urubuga":"questions"===e?"Gucunga ibibazo":"campaigns"===e?"Gucunga kwamamaza":"Ubutumwa bwakiriwe"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,a.jsxs)("div",{className:"text-right hidden md:block",children:[(0,a.jsx)("span",{className:"block text-sm font-bold text-slate-900",children:v.toLocaleTimeString()}),(0,a.jsx)("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:v.toLocaleDateString()})]}),(0,a.jsx)("div",{className:"h-10 w-10 bg-slate-100 rounded-full overflow-hidden border-2 border-white shadow-sm",children:(0,a.jsx)(r.default,{src:"https://ui-avatars.com/api/?name=Admin+User&background=4f46e5&color=fff",alt:"Admin",width:40,height:40,className:"w-full h-full object-cover",unoptimized:!0})})]})]}),(0,a.jsxs)("div",{className:"p-12 max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex space-x-2 mb-10 overflow-x-auto pb-2",children:["live"===e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p,{label:"Abari Gukora",count:A.length,active:!0,icon:"\uD83D\uDFE2",onClick:()=>{}}),(0,a.jsx)("div",{className:"w-px h-10 bg-slate-200 mx-4 self-center"}),(0,a.jsx)("div",{className:"flex items-center space-x-4 pl-4",children:(0,a.jsxs)("div",{className:"flex -space-x-3",children:[A.slice(0,5).map((e,t)=>{var s;return(0,a.jsx)("div",{className:"w-10 h-10 rounded-full border-2 border-white bg-indigo-100 flex items-center justify-center text-xs font-bold text-indigo-700 uppercase",title:e.userName,children:null==(s=e.userName)?void 0:s[0]},t)}),A.length>5&&(0,a.jsxs)("div",{className:"w-10 h-10 rounded-full border-2 border-white bg-slate-100 flex items-center justify-center text-xs font-bold text-slate-500",children:["+",A.length-5]})]})})]}),"questions"===e&&(0,a.jsx)(p,{label:"Ibibazo Byose",count:s.length,active:!0,icon:"\uD83D\uDCE6",onClick:()=>{}})]}),"live"===e&&(0,a.jsxs)("div",{children:[0===A.length&&0===T.length&&(0,a.jsx)(b,{message:"No Action Yet",sub:"Waiting for users to join the quiz..."}),A.length>0&&(0,a.jsxs)("div",{className:"mb-16",children:[(0,a.jsxs)("h2",{className:"text-sm font-black text-slate-400 uppercase tracking-widest mb-6 flex items-center",children:["Abari mu kizamini ubu ",(0,a.jsx)("span",{className:"ml-3 px-2 py-1 bg-indigo-100 text-indigo-600 rounded text-[10px]",children:"LIVE"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:A.map(e=>(0,a.jsx)(g,{session:e,onDelete:S,currentTime:v},e.id))})]}),T.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-sm font-black text-slate-400 uppercase tracking-widest mb-6",children:"Abanditse vuba"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 opacity-80 hover:opacity-100 transition-opacity",children:T.map(e=>(0,a.jsx)(g,{session:e,onDelete:S,currentTime:v},e.id))})]})]}),"questions"===e&&(0,a.jsx)("div",{className:"bg-white rounded-[40px] shadow-xl border border-slate-100 p-8 min-h-[600px]",children:(0,a.jsx)(o.A,{isEmbedded:!0})}),"campaigns"===e&&(0,a.jsx)("div",{className:"bg-white rounded-[40px] shadow-xl border border-slate-100 p-2 min-h-[600px]",children:(0,a.jsx)(x,{})}),"messages"===e&&(0,a.jsx)("div",{className:"bg-white rounded-[40px] shadow-xl border border-slate-100 p-2 min-h-[600px]",children:(0,a.jsx)(u,{})})]})]})]})};function j(){return(0,a.jsx)(f,{})}},6629:(e,t,s)=>{Promise.resolve().then(s.bind(s,3400))}},e=>{e.O(0,[120,239,515,441,255,358],()=>e(e.s=6629)),_N_E=e.O()}]);